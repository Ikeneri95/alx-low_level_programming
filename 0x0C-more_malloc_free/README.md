C - More malloc, free

Trust no one
